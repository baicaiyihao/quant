# BlueQuant - Advanced RPC Load Balancer

## åŠŸèƒ½ç‰¹æ€§

### ğŸš€ é«˜çº§è´Ÿè½½å‡è¡¡ç­–ç•¥
- **å¹³æ»‘åŠ æƒè½®è¯¢ (Smooth Weighted Round Robin)**: é»˜è®¤ç­–ç•¥ï¼Œæ ¹æ®æƒé‡åˆ†é…è¯·æ±‚ï¼Œé¿å…ä¼ ç»ŸåŠ æƒè½®è¯¢çš„çªå‘æ€§
- **è½®è¯¢ (Round Robin)**: ç®€å•çš„è½®è¯¢åˆ†é…
- **æœ€å°‘è¿æ¥ (Least Connections)**: é€‰æ‹©å½“å‰è¿æ¥æ•°æœ€å°‘çš„ç«¯ç‚¹
- **å“åº”æ—¶é—´ä¼˜å…ˆ (Response Time)**: é€‰æ‹©å“åº”æ—¶é—´æœ€çŸ­çš„ç«¯ç‚¹
- **éšæœºé€‰æ‹© (Random)**: éšæœºé€‰æ‹©ç«¯ç‚¹

### ğŸ“Š æ™ºèƒ½ç›‘æ§
- **å®æ—¶å“åº”æ—¶é—´ç›‘æ§**: ä½¿ç”¨æŒ‡æ•°ç§»åŠ¨å¹³å‡è®¡ç®—å¹³å‡å“åº”æ—¶é—´
- **æˆåŠŸç‡ç»Ÿè®¡**: è·Ÿè¸ªæ¯ä¸ªç«¯ç‚¹çš„æˆåŠŸ/å¤±è´¥ç‡
- **å¥åº·æ£€æŸ¥**: å®šæœŸæ£€æŸ¥ç«¯ç‚¹å¯ç”¨æ€§
- **è‡ªåŠ¨æ•…éšœæ¢å¤**: æŒ‡æ•°é€€é¿æœºåˆ¶ï¼Œè‡ªåŠ¨æ¢å¤æ•…éšœç«¯ç‚¹

### ğŸ”§ é…ç½®çµæ´»
- **æƒé‡é…ç½®**: æ”¯æŒé€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®ç«¯ç‚¹æƒé‡
- **ç­–ç•¥åˆ‡æ¢**: è¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢è´Ÿè½½å‡è¡¡ç­–ç•¥
- **è¯¦ç»†ç›‘æ§**: æä¾›ç«¯ç‚¹å’Œæ•´ä½“æ€§èƒ½æŒ‡æ ‡

## ç¯å¢ƒå˜é‡é…ç½®

### åŸºæœ¬é…ç½®
```bash
# å•ä¸ªç«¯ç‚¹
ENDPPOINT=https://sui-mainnet.blockvision.org

# å¤šä¸ªç«¯ç‚¹ï¼ˆæ”¯æŒæƒé‡ï¼‰
ENDPPOINT=https://sui-mainnet.blockvision.org:3
ENDPPOINT1=https://sui-mainnet-rpc.allthatnode.com:2
ENDPPOINT2=https://sui-mainnet-rpc.nodereal.io:1
```

### æƒé‡è¯´æ˜
- æƒé‡æ ¼å¼ï¼š`url:weight`
- æƒé‡è¶Šé«˜ï¼Œåˆ†é…åˆ°çš„è¯·æ±‚è¶Šå¤š
- é»˜è®¤æƒé‡ä¸º1
- æœ€å°æƒé‡ä¸º1

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨
```typescript
import { createBalancedSuiClient } from './src/rpc-balancer';

// ä½¿ç”¨é»˜è®¤ç­–ç•¥ï¼ˆå¹³æ»‘åŠ æƒè½®è¯¢ï¼‰
const client = createBalancedSuiClient();

// è·å–è´¦æˆ·ä½™é¢
const balance = await client.getBalance({
    owner: "0x...",
    coinType: "0x2::sui::SUI"
});
```

### æŒ‡å®šç­–ç•¥
```typescript
import { createBalancedSuiClient, getRPCLoadBalancer } from './src/rpc-balancer';

// ä½¿ç”¨å“åº”æ—¶é—´ä¼˜å…ˆç­–ç•¥
const client = createBalancedSuiClient('response_time');

// æˆ–è€…åŠ¨æ€åˆ‡æ¢ç­–ç•¥
const balancer = getRPCLoadBalancer();
balancer.setStrategy('least_connections');
```

### ç›‘æ§å’ŒçŠ¶æ€
```typescript
import { getRPCLoadBalancer } from './src/rpc-balancer';

const balancer = getRPCLoadBalancer();

// è·å–è¯¦ç»†çŠ¶æ€
const status = balancer.getStatus();
console.log('Load Balancer Status:', status);

// è·å–æ€§èƒ½æŒ‡æ ‡
const metrics = balancer.getMetrics();
console.log('Performance Metrics:', metrics);
```

## è´Ÿè½½å‡è¡¡ç­–ç•¥è¯¦è§£

### 1. å¹³æ»‘åŠ æƒè½®è¯¢ (weighted_round_robin)
- **ç®—æ³•**: å¹³æ»‘åŠ æƒè½®è¯¢ç®—æ³•ï¼Œé¿å…ä¼ ç»ŸåŠ æƒè½®è¯¢çš„çªå‘æ€§
- **é€‚ç”¨åœºæ™¯**: ç«¯ç‚¹æ€§èƒ½å·®å¼‚è¾ƒå¤§ï¼Œéœ€è¦æŒ‰æƒé‡åˆ†é…è´Ÿè½½
- **ä¼˜åŠ¿**: åˆ†é…æ›´å‡åŒ€ï¼Œé¿å…çªå‘æµé‡

### 2. è½®è¯¢ (round_robin)
- **ç®—æ³•**: ç®€å•çš„è½®è¯¢åˆ†é…
- **é€‚ç”¨åœºæ™¯**: ç«¯ç‚¹æ€§èƒ½ç›¸è¿‘ï¼Œéœ€è¦å‡åŒ€åˆ†é…
- **ä¼˜åŠ¿**: å®ç°ç®€å•ï¼Œåˆ†é…å‡åŒ€

### 3. æœ€å°‘è¿æ¥ (least_connections)
- **ç®—æ³•**: é€‰æ‹©å½“å‰è¯·æ±‚æ•°æœ€å°‘çš„ç«¯ç‚¹
- **é€‚ç”¨åœºæ™¯**: ç«¯ç‚¹å¤„ç†èƒ½åŠ›å·®å¼‚è¾ƒå¤§
- **ä¼˜åŠ¿**: è´Ÿè½½åˆ†é…æ›´å‡è¡¡

### 4. å“åº”æ—¶é—´ä¼˜å…ˆ (response_time)
- **ç®—æ³•**: é€‰æ‹©å¹³å‡å“åº”æ—¶é—´æœ€çŸ­çš„ç«¯ç‚¹
- **é€‚ç”¨åœºæ™¯**: å¯¹å“åº”æ—¶é—´æ•æ„Ÿçš„åº”ç”¨
- **ä¼˜åŠ¿**: ä¼˜å…ˆä½¿ç”¨æ€§èƒ½æœ€å¥½çš„ç«¯ç‚¹

### 5. éšæœºé€‰æ‹© (random)
- **ç®—æ³•**: éšæœºé€‰æ‹©ç«¯ç‚¹
- **é€‚ç”¨åœºæ™¯**: ç®€å•çš„è´Ÿè½½åˆ†æ•£
- **ä¼˜åŠ¿**: å®ç°ç®€å•ï¼Œé¿å…çƒ­ç‚¹

## ç›‘æ§æŒ‡æ ‡

### ç«¯ç‚¹çŠ¶æ€
```typescript
{
  url: string,
  isActive: boolean,
  isHealthy: boolean,
  weight: number,
  currentWeight: number,
  failureCount: number,
  backoffDelay: number,
  responseTime: number,
  successRate: string,
  totalRequests: number,
  successCount: number,
  timeSinceLastFailure: number | null
}
```

### æ•´ä½“æŒ‡æ ‡
```typescript
{
  avgResponseTime: number,
  totalRequests: number,
  totalSuccess: number,
  overallSuccessRate: string,
  activeEndpointCount: number
}
```

## æ•…éšœå¤„ç†æœºåˆ¶

### è‡ªåŠ¨æ•…éšœæ£€æµ‹
- è¿ç»­å¤±è´¥3æ¬¡åè‡ªåŠ¨ç¦ç”¨ç«¯ç‚¹
- æŒ‡æ•°é€€é¿é‡è¯•æœºåˆ¶
- å®šæœŸå¥åº·æ£€æŸ¥æ¢å¤

### æ•…éšœæ¢å¤
- ç«¯ç‚¹æ¢å¤åè‡ªåŠ¨é‡æ–°å¯ç”¨
- é‡ç½®å¤±è´¥è®¡æ•°å’Œæƒé‡
- æ¸è¿›å¼æ¢å¤ç­–ç•¥

## æ€§èƒ½ä¼˜åŒ–

### å“åº”æ—¶é—´ä¼˜åŒ–
- ä½¿ç”¨æŒ‡æ•°ç§»åŠ¨å¹³å‡è®¡ç®—å“åº”æ—¶é—´
- å¹³æ»‘å› å­ä¸º0.1ï¼Œå¹³è¡¡å“åº”æ€§å’Œç¨³å®šæ€§
- æœ€å¤§å“åº”æ—¶é—´é˜ˆå€¼ï¼š10ç§’

### å¥åº·æ£€æŸ¥
- æ£€æŸ¥é—´éš”ï¼š30ç§’
- ä½¿ç”¨è½»é‡çº§APIè°ƒç”¨è¿›è¡Œå¥åº·æ£€æŸ¥
- å¹¶è¡Œæ£€æŸ¥æ‰€æœ‰ç«¯ç‚¹

## æœ€ä½³å®è·µ

1. **æƒé‡è®¾ç½®**: æ ¹æ®ç«¯ç‚¹æ€§èƒ½å’Œç¨³å®šæ€§è®¾ç½®åˆç†æƒé‡
2. **ç­–ç•¥é€‰æ‹©**: æ ¹æ®åº”ç”¨éœ€æ±‚é€‰æ‹©åˆé€‚çš„è´Ÿè½½å‡è¡¡ç­–ç•¥
3. **ç›‘æ§**: å®šæœŸæ£€æŸ¥ç«¯ç‚¹å’Œæ•´ä½“æ€§èƒ½æŒ‡æ ‡
4. **æ•…éšœå¤„ç†**: ç›‘æ§å¤±è´¥ç‡ï¼ŒåŠæ—¶è°ƒæ•´é…ç½®

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **æ— å¯ç”¨ç«¯ç‚¹**: æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®å’Œç½‘ç»œè¿æ¥
2. **å“åº”æ—¶é—´è¿‡é•¿**: è€ƒè™‘åˆ‡æ¢åˆ°å“åº”æ—¶é—´ä¼˜å…ˆç­–ç•¥
3. **æˆåŠŸç‡ä½**: æ£€æŸ¥ç«¯ç‚¹é…ç½®å’Œç½‘ç»œç¨³å®šæ€§

### è°ƒè¯•ä¿¡æ¯
```typescript
// å¯ç”¨è¯¦ç»†æ—¥å¿—
const balancer = getRPCLoadBalancer();
console.log('Status:', balancer.getStatus());
console.log('Metrics:', balancer.getMetrics());
```